<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Admin Dashboard</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
    body { font-family: 'Inter', sans-serif; }
</style>
</head>
<body class="bg-gray-50 p-6">

<!-- En-tête avec Déconnexion et Accueil -->
<div class="flex justify-between items-center mb-6">
    <h1 class="text-2xl font-bold">Admin Dashboard</h1>
    <div class="flex gap-2">
        <a href="{{ url_for('admin_logout') }}" 
           class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition">
            Déconnexion
        </a>
        <a href="{{ url_for('home') }}" 
           class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600 transition">
            Accueil
        </a>
    </div>
</div>

<!-- Messages flash -->
{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
            {% if category in ['admin_success', 'success'] %}
                <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg mb-4 text-sm" role="alert">
                    {{ message }}
                </div>
            {% elif category in ['admin_error', 'admin_warning', 'error'] %}
                <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-4 text-sm" role="alert">
                    {{ message }}
                </div>
            {% elif category == 'admin_info' %}
                <div class="bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded-lg mb-4 text-sm" role="alert">
                    {{ message }}
                </div>
            {% endif %}
        {% endfor %}
    {% endif %}
{% endwith %}

<!-- Formulaire pour ajouter un produit -->
<form method="POST" class="mb-6 bg-white p-4 rounded shadow flex flex-wrap items-center gap-2">
    <input type="text" name="designation" placeholder="Nom du produit" class="border p-2 rounded flex-1 min-w-[150px]" required>
    <input type="number" name="price" step="0.01" placeholder="Prix (F)" class="border p-2 rounded w-[120px]" required>
    <select name="category" class="border p-2 rounded" required>
        <option value="foyer">Articles du Foyer</option>
        <option value="marche">Produits du Marché</option>
    </select>
    <label class="flex items-center gap-1">
        <input type="checkbox" name="is_footer">
        Pied de liste
    </label>
    <button type="submit" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition">
        Ajouter
    </button>
</form>

<!-- Articles du Foyer -->
<h2 class="text-xl font-bold mt-6 mb-2">Articles du Foyer</h2>
<table class="table-auto w-full bg-white rounded shadow mb-6">
<thead>
<tr class="bg-gray-200">
    <th class="px-4 py-2">ID</th>
    <th class="px-4 py-2">Nom</th>
    <th class="px-4 py-2">Prix (F)</th>
    <th class="px-4 py-2">Footer</th>
    <th class="px-4 py-2">Actions</th>
</tr>
</thead>
<tbody>
{% for product in products_foyer %}
<tr class="hover:bg-gray-50 transition">
    <td class="border px-4 py-2">{{ product.id }}</td>
    <td class="border px-4 py-2">{{ product.designation }}</td>
    <td class="border px-4 py-2">{{ "%.2f"|format(product.price) }}</td>
    <td class="border px-4 py-2">{{ 'Oui' if product.is_footer else 'Non' }}</td>
    <td class="border px-4 py-2">
        <form method="POST" style="display:inline">
            <input type="hidden" name="delete_id" value="{{ product.id }}">
            <button type="submit" class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 transition">
                Supprimer
            </button>
        </form>
    </td>
</tr>
{% else %}
<tr>
    <td colspan="5" class="border px-4 py-2 text-center">Aucun produit.</td>
</tr>
{% endfor %}
</tbody>
</table>

<!-- Produits du Marché -->
<h2 class="text-xl font-bold mt-6 mb-2">Produits du Marché</h2>
<table class="table-auto w-full bg-white rounded shadow">
<thead>
<tr class="bg-gray-200">
    <th class="px-4 py-2">ID</th>
    <th class="px-4 py-2">Nom</th>
    <th class="px-4 py-2">Prix (F)</th>
    <th class="px-4 py-2">Footer</th>
    <th class="px-4 py-2">Actions</th>
</tr>
</thead>
<tbody>
{% for product in products_marche %}
<tr class="hover:bg-gray-50 transition">
    <td class="border px-4 py-2">{{ product.id }}</td>
    <td class="border px-4 py-2">{{ product.designation }}</td>
    <td class="border px-4 py-2">{{ "%.2f"|format(product.price) }}</td>
    <td class="border px-4 py-2">{{ 'Oui' if product.is_footer else 'Non' }}</td>
    <td class="border px-4 py-2">
        <form method="POST" style="display:inline">
            <input type="hidden" name="delete_id" value="{{ product.id }}">
            <button type="submit" class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 transition">
                Supprimer
            </button>
        </form>
    </td>
</tr>
{% else %}
<tr>
    <td colspan="5" class="border px-4 py-2 text-center">Aucun produit.</td>
</tr>
{% endfor %}
</tbody>
</table>

</body>
</html>
